---
- name: Install vscode
  tags: vscode
  become: true
  ansible.builtin.apt:
    deb: https://code.visualstudio.com/sha/download?build=stable&os=linux-deb-x64
  # dependency problem with libglib2.0-0
  failed_when: false

- name: Install vscode user settings file
  tags: rclone
  ansible.builtin.include_tasks: "{{ role_path }}/../dotfiles/tasks/link_dotfiles.yml"
  vars:
    dotfiles:
      - config/Code/User/settings.json
      - config/Code/User/keybindings.json

- name: Install vscode extensions
  ansible.builtin.command:
    cmd: code --install-extension "{{ item }}" --force
  # never changed, because otherwise is always changed
  changed_when: false
  loop:
    - golang.go
    - redhat.vscode-yaml
    - 42crunch.vscode-openapi
    - ms-python.python
    - charliermarsh.ruff
    - stkb.rewrap
    - ms-python.mypy-type-checker
    - puppet.puppet-vscode
    - yzhang.markdown-all-in-one
